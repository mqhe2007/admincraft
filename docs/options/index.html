<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>模块配置 | Admincraft</title>
    <meta name="description" content="中后台应用快速搭建工具">
    
    
    <link rel="preload" href="/admincraft/assets/css/0.styles.01a8d6d9.css" as="style"><link rel="preload" href="/admincraft/assets/js/app.6f1dfc39.js" as="script"><link rel="preload" href="/admincraft/assets/js/10.f632cc8d.js" as="script"><link rel="prefetch" href="/admincraft/assets/js/11.903616d8.js"><link rel="prefetch" href="/admincraft/assets/js/12.6093ce8a.js"><link rel="prefetch" href="/admincraft/assets/js/2.6273f23d.js"><link rel="prefetch" href="/admincraft/assets/js/3.b97cadd4.js"><link rel="prefetch" href="/admincraft/assets/js/4.73ad6f11.js"><link rel="prefetch" href="/admincraft/assets/js/5.7d0c8fad.js"><link rel="prefetch" href="/admincraft/assets/js/6.692515b0.js"><link rel="prefetch" href="/admincraft/assets/js/7.3896eef9.js"><link rel="prefetch" href="/admincraft/assets/js/8.770950b7.js"><link rel="prefetch" href="/admincraft/assets/js/9.49f5c2f1.js">
    <link rel="stylesheet" href="/admincraft/assets/css/0.styles.01a8d6d9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/admincraft/" class="home-link router-link-active"><!----> <span class="site-name">Admincraft</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/admincraft/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/admincraft/api/" class="nav-link">API</a></div><div class="nav-item"><a href="/admincraft/code/" class="nav-link">编码规范</a></div><div class="nav-item"><a href="/admincraft/appendix/" class="nav-link">附录</a></div><div class="nav-item"><a href="/admincraft/qa/" class="nav-link">常见问题</a></div><div class="nav-item"><a href="https://github.com/mqhe2007/admincraft" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/admincraft/guide/" class="nav-link">指南</a></div><div class="nav-item"><a href="/admincraft/api/" class="nav-link">API</a></div><div class="nav-item"><a href="/admincraft/code/" class="nav-link">编码规范</a></div><div class="nav-item"><a href="/admincraft/appendix/" class="nav-link">附录</a></div><div class="nav-item"><a href="/admincraft/qa/" class="nav-link">常见问题</a></div><div class="nav-item"><a href="https://github.com/mqhe2007/admincraft" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content"><h1 id="模块配置"><a href="#模块配置" aria-hidden="true" class="header-anchor">#</a> 模块配置</h1> <div class="danger custom-block"><p class="custom-block-title">WARNING</p> <p>本页文档正在撰写中，请勿参考。</p></div> <p>可配置项通过<code>/src/config.js</code>文件进行配置。</p> <h2 id="基本信息"><a href="#基本信息" aria-hidden="true" class="header-anchor">#</a> 基本信息</h2> <p>基本信息，用来描述此工程。</p> <h3 id="name"><a href="#name" aria-hidden="true" class="header-anchor">#</a> name</h3> <p>类型：<code>String</code></p> <p>vue 工程的名称。</p> <p>模块名称遵从 npm 包命名规范，单词小写，多单词使用<code>-</code>连接。</p> <h3 id="version"><a href="#version" aria-hidden="true" class="header-anchor">#</a> version</h3> <p>类型：<code>String</code></p> <p>vue 工程的版本号，版本号命名应遵从<a href="https://semver.org/lang/zh-CN/" target="_blank" rel="noopener noreferrer">语义化版本规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h3 id="author"><a href="#author" aria-hidden="true" class="header-anchor">#</a> author</h3> <p>类型：<code>name &lt;email&gt;</code></p> <p>vue 远程模块作者，暂时无用。</p> <h2 id="外部依赖"><a href="#外部依赖" aria-hidden="true" class="header-anchor">#</a> 外部依赖</h2> <p><code>/src/externals.js</code></p> <p>框架开发人员得到模块开发人员的外部依赖清单后，需要在此文件中手动添加外部依赖，这些外部依赖在主框架打包时会被单独打包，以便更好的缓存。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> jquery <span class="token keyword">from</span> <span class="token string">'jquery'</span>
<span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">'axios'</span>
window<span class="token punctuation">.</span>$ <span class="token operator">=</span> jquery
window<span class="token punctuation">.</span>axios <span class="token operator">=</span> axios
</code></pre></div><p>同样，在框架中要用的第三方包也可以添加到本文件中。</p> <p>这个文件会在<code>/src/main.js</code>中首先被导入，所以在我们的项目文件中无需导入，可以直接使用添加在 window 上的全局变量。</p> <h2 id="构建模式"><a href="#构建模式" aria-hidden="true" class="header-anchor">#</a> 构建模式</h2> <p>构建模式是一个非常有用的配置，此处的构建模式不完全等于<a href="https://cli.vuejs.org/zh/guide/mode-and-env.html#%E6%A8%A1%E5%BC%8F" target="_blank" rel="noopener noreferrer">vue-cli@3 的模式<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，我们只是通过 vue-cli@3 的模式机制，动态赋值<code>VUE_APP_MODE</code>常量，并在环境变量中根据<code>VUE_APP_MODE</code>的值动态切换变量对象。</p> <p><code>.env.test42</code>文件为例：</p> <div class="language-bash extra-class"><pre class="language-bash"><code>NODE_ENV<span class="token operator">=</span>production <span class="token comment"># 以生产配置构建</span>
VUE_APP_MODE<span class="token operator">=</span>test42 <span class="token comment"># 设置VUE_APP_MODE值</span>
</code></pre></div><p>这样做的目的也是为了我们能够集中的管理环境变量。见下文。</p> <h2 id="环境变量"><a href="#环境变量" aria-hidden="true" class="header-anchor">#</a> 环境变量</h2> <p>环境变量记录着整个模块用到的各种依环境不同而不同的常量。在项目任意地方导入后可以直接使用常量，避免了手动或通过 CI 另外配置替换环境变量的麻烦事儿。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 项目中中所使用的常量</span>
<span class="token keyword">const</span> _env <span class="token operator">=</span> <span class="token punctuation">{</span>
  development<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 开发环境</span>
    <span class="token constant">API_BASE</span><span class="token punctuation">:</span> <span class="token string">'http://localhost:8083'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  production<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 正式生产环境</span>
    <span class="token constant">API_BASE</span><span class="token punctuation">:</span> <span class="token string">'http://qingjin.me'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  test42<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 42测试环境</span>
    <span class="token constant">API_BASE</span><span class="token punctuation">:</span> <span class="token string">'http://test42.com'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> env <span class="token operator">=</span> _env<span class="token punctuation">[</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_MODE</span><span class="token punctuation">]</span> <span class="token comment">// 通过构建模式来动态获取环境变量</span>
</code></pre></div><p>使用：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> env <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/config'</span>
axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>env<span class="token punctuation">.</span><span class="token constant">API_BASE</span> <span class="token operator">+</span> <span class="token string">'/something'</span><span class="token punctuation">)</span>
</code></pre></div><p>希望根据不同运行环境进行切换的变量一定要拥有相同的<code>key</code>值。</p> <h2 id="模块库"><a href="#模块库" aria-hidden="true" class="header-anchor">#</a> 模块库</h2> <p>框架开发者从远程模块开发者处得到远程模块的部署地址列表，按不同的环境配置在<code>_moduleLibs</code>对象中。</p> <p>key值为模块名称，value为部署地址。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 远程模块列表</span>
<span class="token keyword">const</span> _moduleLibs <span class="token operator">=</span> <span class="token punctuation">{</span>
  development<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    clkm<span class="token punctuation">:</span> <span class="token string">'http://qingjin.me/clkm.umd.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  production<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    clkm<span class="token punctuation">:</span> <span class="token string">'http://qingjin.me/clkm.umd.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  test42<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    clkm<span class="token punctuation">:</span> <span class="token string">'http://test42.com/clkm.umd.js'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> moduleLibs <span class="token operator">=</span> _moduleLibs<span class="token punctuation">[</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_APP_MODE</span><span class="token punctuation">]</span>
</code></pre></div><p><code>moduleLibs</code>对象会被导入路由配置文件，在获取远程模块时通过<code>route.path</code>动态选取模块地址。</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/admincraft/assets/js/app.6f1dfc39.js" defer></script><script src="/admincraft/assets/js/10.f632cc8d.js" defer></script>
  </body>
</html>
